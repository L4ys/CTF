#include <stdint.h>
#include "defs.h"

unsigned char* byte_8A0 = "\x9c\x10\x1c\x57\x72\xab\xae\xde\xc0\x51\x85\xd7\xa6\x59\x4d\x7c\x78\xc3\xfc\xa7\xd3\x4f\x5e\xc2\x9c\x41\x44\x3e\xd2\xb9\x74\x6b";
unsigned char* byte_8C8 = "\x3a\xc3\xf5\x23\x48\xb6\xa0\xd9\x43\x10\x25\x07\xce\x6d\xd7\x31\xde\x10\x15\xd3\xe9\x52\x50\xc5\x1f\x00\xe4\xee\xba\x8d\xee\x26";
unsigned char* byte_8F0 = "\x38\xc2\x75\x63\xe8\xe6\x88\xcd\xc9\x55\x87\x56\xe6\x79\xdd\x34\xdc\x11\x95\x93\x49\x02\x78\xd1\x95\x45\x46\xbf\x92\x99\xe4\x23";
unsigned char* byte_918 = "\xd1\x36\x0f\xde\xb6\xc9\x9f\xc6\x4c\x97\xe6\x66\x7e\x35\x7b\xe7\x35\xe5\xef\x2e\x17\x2d\x6f\xda\x10\x87\x27\x8f\x0a\xd5\x42\xf0";
unsigned char* byte_940 = "\x89\x1a\x19\x55\xf3\xeb\x8e\xce\x48\x95\xe7\x66\xfe\xf5\x1b\x57\x6d\xc9\xf9\xa5\x52\x0f\x7e\xd2\x14\x85\x26\x8f\x8a\x15\x22\x40";
unsigned char* byte_968 = "\xca\x3b\x09\x5d\x77\x29\xef\xfe\xd0\x59\x01\x15\xc7\xe9\x15\xd0\x2e\xe8\xe9\xad\xd6\xcd\x1f\xe2\x8c\x49\xc0\xfc\xb3\x09\x2c\xc7";
unsigned char* byte_990 = "\xc3\x3f\x0b\x5c\xf7\x69\x4f\xae\xf8\xcd\x4b\x30\x55\xa0\x31\xc2\x27\xec\xeb\xac\x56\x8d\xbf\xb2\xa4\xdd\x8a\xd9\x21\x40\x08\xd5";
unsigned char* byte_9B8 = "\xc4\x3c\x0a\x5c\xf7\x69\x4f\xae\xf8\x4d\x8b\xd0\x25\x98\x2d\xcc\x20\xef\xea\xac\x56\x8d\xbf\xb2\xa4\x5d\x4a\x39\x51\x78\x14\xdb";
unsigned char* byte_9E0 = "\xcd\x38\x08\x5d\xf7\x69\x4f\xae\xf8\xcd\xcb\xf0\xb5\xd0\x09\xde\x29\xeb\xe8\xad\x56\x8d\xbf\xb2\xa4\xdd\x0a\x19\xc1\x30\x30\xc9";
unsigned char* byte_A08 = "\xc1\x3e\x0b\x5c\xf7\x69\x4f\xae\xf8\xcd\xcb\x70\x75\xb0\x39\xc6\x25\xed\xeb\xac\x56\x8d\xbf\xb2\xa4\xdd\x0a\x99\x01\x50\x00\xd1";
unsigned char* byte_A30 = "\xce\x39\x08\x5d\xf7\x69\x4f\xae\xf8\x4d\x0b\x90\x85\xc8\x05\xd8\x2a\xea\xe8\xad\x56\x8d\xbf\xb2\xa4\x5d\xca\x79\xf1\x28\x3c\xcf";
unsigned char* byte_A58 = "\xdb\x33\x0d\x5f\xf6\x69\x4f\xae\x78\x8d\x6b\x20\xdd\x64\x53\xf3\x3f\xe0\xed\xaf\x57\x8d\xbf\xb2\x24\x9d\xaa\xc9\xa9\x84\x6a\xe4";
unsigned char* byte_A80 = "\x19\xd2\xfd\xa7\x0a\x17\x70\xb1\x77\x8a\xe8\x61\xfd\x74\x5b\x77\xfd\x01\x1d\x57\xab\xf3\x80\xad\x2b\x9a\x29\x88\x89\x94\x62\x60";
unsigned char* byte_AA8 = "\x2c\xc8\x70\x61\xe9\xe6\x08\x8d\xe9\x45\x8f\xd2\xa4\xd8\x8d\x1c\xc8\x1b\x90\x91\x48\x02\xf8\x91\xb5\x55\x4e\x3b\xd0\x38\xb4\x0b";
unsigned char* byte_AD0 = "\x3c\xc0\x74\x63\xe8\xe6\x08\x8d\x69\x05\xaf\xc2\xac\x5c\xcf\x3d\xd8\x13\x94\x93\x49\x02\xf8\x91\x35\x15\x6e\x2b\xd8\xbc\xf6\x2a";
unsigned char* byte_AF8 = "\x35\xc4\x76\x62\xe8\xe6\x08\x8d\x69\x85\xef\xe2\x3c\x14\xeb\x2f\xd1\x17\x96\x92\x49\x02\xf8\x91\x35\x95\x2e\x0b\x48\xf4\xd2\x38";
unsigned char* byte_B20 = "\x25\xcc\x72\x60\xe9\xe6\x08\x8d\x69\x85\xef\xe2\x3c\x94\xab\x0f\xc1\x1f\x92\x90\x48\x02\xf8\x91\x35\x95\x2e\x0b\x48\x74\x92\x18";
unsigned char* byte_B48 = "\x23\xcf\x73\x60\xe9\xe6\x08\x8d\xe9\xc5\x4f\x32\x54\xa0\xb1\x02\xc7\x1c\x93\x90\x48\x02\xf8\x91\xb5\xd5\x8e\xdb\x20\x40\x88\x15";
unsigned char* byte_B70 = "\x25\xcc\x72\x60\xe9\xe6\x08\x8d\xe9\xc5\xcf\xf2\x34\x90\xa9\x0e\xc1\x1f\x92\x90\x48\x02\xf8\x91\xb5\xd5\x0e\x1b\x40\x70\x90\x19";
unsigned char* byte_B98 = "\x1f\xd1\x7c\x67\xea\xe7\x08\x8d\x69\x85\x6f\xa2\x9c\x44\x43\x7b\xfb\x02\x9c\x97\x4b\x03\xf8\x91\x35\x95\xae\x4b\xe8\xa4\x7a\x6c";
unsigned char* byte_BC0 = "\x7f\xe1\xe4\x2b\x4c\xb4\xa1\xd9\x43\x90\x65\xa7\x9e\x45\xc3\xbb\x9b\x32\x04\xdb\xed\x50\x51\xc5\x1f\x80\xa4\x4e\xea\xa5\xfa\xac";
unsigned char* byte_BE8 = "\x73\xe7\xe7\x2a\x4c\xb4\xa1\xd9\xc3\xd0\x45\x37\x56\x21\xf1\xa2\x97\x34\x07\xda\xed\x50\x51\xc5\x9f\xc0\x84\xde\x22\xc1\xc8\xb5";
unsigned char* byte_C10 = "\x7d\xe0\xe4\x2b\x4c\xb4\xa1\xd9\x43\x90\xe5\xe7\xbe\x55\xcb\xbf\x99\x33\x04\xdb\xed\x50\x51\xc5\x1f\x80\x24\x0e\xca\xb5\xf2\xa8";
unsigned char* byte_C38 = "\x63\xef\xe3\x28\x4d\xb4\xa1\xd9\x43\x90\x65\x27\x5e\xa5\xb3\x83\x87\x3c\x03\xd8\xec\x50\x51\xc5\x1f\x80\xa4\xce\x2a\x45\x8a\x94";
unsigned char* byte_C60 = "\x62\xef\xe3\x28\x4d\xb4\xa1\xd9\xc3\x50\x05\x17\x46\xa9\xb5\x80\x86\x3c\x03\xd8\xec\x50\x51\xc5\x9f\x40\xc4\xfe\x32\x49\x8c\x97";
unsigned char* byte_C88 = "\xb4\x84\xd6\x32\x40\xb2\xa2\xd8\x43\x10\xa5\xc7\x2e\x1d\xef\x2d\x50\x57\x36\xc2\xe1\x56\x52\xc4\x1f\x00\x64\x2e\x5a\xfd\xd6\x3a";

__int64 get_key(unsigned __int16 a1)
{
  int v1; // eax

  v1 = a1;
  LOWORD(v1) = a1 >> 1;
  return v1 | (a1 << 15);
}

void sub_1DF(unsigned int seed, char *out)
{
  __int16 v2; // ax
  unsigned __int16 v3; // [rsp+Ch] [rbp-54h]
  _WORD v4[32]; // [rsp+10h] [rbp-50h]
  int i; // [rsp+5Ch] [rbp-4h]

  v3 = seed;
  v4[0] = 0x9DF9u;
  v4[1] = 0x65E;
  v4[2] = 0x3B94;
  v4[3] = 0xFAD9u;
  v4[4] = 0xC3D9u;
  v4[5] = 0xFE12u;
  v4[6] = 0xA57Bu;
  v4[7] = 0x9089u;
  v4[8] = 0x3FAF;
  v4[9] = 0xBB31u;
  v4[10] = 0x4CAD;
  v4[11] = 0x1415;
  v4[12] = 0x74CD;
  v4[13] = 0xCF0Au;
  v4[14] = 0x1CE1;
  v4[15] = 0xB55Au;
  v4[16] = 0x54C6;
  v4[17] = 0x827Fu;
  v4[18] = 0x179D;
  v4[19] = 0x66D9;
  v4[20] = 0xFF80u;
  v4[21] = 0x8126u;
  v4[22] = 0x5579;
  v4[23] = 0x4AED;
  v4[24] = 0x5F7D;
  v4[25] = 0x430F;
  v4[26] = 0x2EE4;
  v4[27] = 0x129C;
  v4[28] = 0xDBCDu;
  v4[29] = 0xEB50u;
  v4[30] = 0x8DA8u;
  v4[31] = 0xBDD1u;
  for ( i = 0; i <= 31; ++i )
  {
    v2 = get_key(v3);
    v3 = v2 ^ v4[i];
    out[i] = v3;
  }
}

int main(int argc, char *argv[])
{
  char *v3[32]; 
  v3[0] = byte_8A0;
  v3[1] = byte_8C8;
  v3[2] = byte_8F0;
  v3[3] = byte_918;
  v3[4] = byte_940;
  v3[5] = byte_940;
  v3[6] = byte_940;
  v3[7] = byte_968;
  v3[8] = byte_990;
  v3[9] = byte_9B8;
  v3[10] = byte_9E0;
  v3[11] = byte_A08;
  v3[12] = byte_A08;
  v3[13] = byte_A30;
  v3[14] = byte_A58;
  v3[15] = byte_A80;
  v3[16] = byte_AA8;
  v3[17] = byte_AD0;
  v3[18] = byte_AF8;
  v3[19] = byte_B20;
  v3[20] = byte_B48;
  v3[21] = byte_B70;
  v3[22] = byte_B98;
  v3[23] = byte_B98;
  v3[24] = byte_BC0;
  v3[25] = byte_BE8;
  v3[26] = byte_C10;
  v3[27] = byte_C38;
  v3[28] = byte_C60;
  v3[29] = byte_C10;
  v3[30] = byte_C88;
  v3[31] = byte_C88;

  char out[40] = {0};

  for (int k = 0; k < 32; ++k ) {
	  for (unsigned int i = 0; i < 0xffff; ++i ) {
		  sub_1DF(i, out);
		  if (!memcmp(out, v3[k], 32)) {
			  printf("seed[%d]=%x\n", k,i);
              break;
		  }

	  }
  }

  return 0;
}
